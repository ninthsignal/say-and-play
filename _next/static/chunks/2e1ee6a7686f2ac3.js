(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,78333,(e,t,i)=>{var n=0/0,s=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,c=parseInt,l=e.g&&e.g.Object===Object&&e.g,h="object"==typeof self&&self&&self.Object===Object&&self,u=l||h||Function("return this")(),g=Object.prototype.toString,p=Math.max,d=Math.min,f=function(){return u.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function b(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==g.call(t))return n;if(m(e)){var t,i="function"==typeof e.valueOf?e.valueOf():e;e=m(i)?i+"":i}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var l=o.test(e);return l||a.test(e)?c(e.slice(2),l?2:8):r.test(e)?n:+e}t.exports=function(e,t,i){var n,s,r,o,a,c,l=0,h=!1,u=!1,g=!0;if("function"!=typeof e)throw TypeError("Expected a function");function y(t){var i=n,r=s;return n=s=void 0,l=t,o=e.apply(r,i)}function x(e){var i=e-c,n=e-l;return void 0===c||i>=t||i<0||u&&n>=r}function v(){var e,i,n,s=f();if(x(s))return w(s);a=setTimeout(v,(e=s-c,i=s-l,n=t-e,u?d(n,r-i):n))}function w(e){return(a=void 0,g&&n)?y(e):(n=s=void 0,o)}function T(){var e,i=f(),r=x(i);if(n=arguments,s=this,c=i,r){if(void 0===a)return l=e=c,a=setTimeout(v,t),h?y(e):o;if(u)return a=setTimeout(v,t),y(c)}return void 0===a&&(a=setTimeout(v,t)),o}return t=b(t)||0,m(i)&&(h=!!i.leading,r=(u="maxWait"in i)?p(b(i.maxWait)||0,t):r,g="trailing"in i?!!i.trailing:g),T.cancel=function(){void 0!==a&&clearTimeout(a),l=0,n=c=s=a=void 0},T.flush=function(){return void 0===a?o:w(f())},T}},48218,61881,e=>{"use strict";let t;function i(e,t,i,n,s,r,o){try{var a=e[r](o),c=a.value}catch(e){i(e);return}a.done?t(c):Promise.resolve(c).then(n,s)}function n(e){return function(){var t=this,n=arguments;return new Promise(function(s,r){var o=e.apply(t,n);function a(e){i(o,s,r,a,c,"next",e)}function c(e){i(o,s,r,a,c,"throw",e)}a(void 0)})}}e.s(["default",()=>T,"useSpeechRecognition",()=>w],48218);var s=e.i(71645),r=e.i(78333);let o="undefined"!=typeof window&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition);var a=()=>/(android)/i.test("undefined"!=typeof navigator?navigator.userAgent:"");let c=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.map(e=>e.trim()).join(" ").trim()},l=/\s*\((.*?)\)\s*/g,h=/(\(\?:[^)]+\))\?/g,u=/(\(\?)?:\w+/g,g=/\*/g,p=/[-{}[\]+?.,\\^$|#]/g,d=()=>"undefined"!=typeof window&&void 0!==window.navigator&&void 0!==window.navigator.mediaDevices&&void 0!==window.navigator.mediaDevices.getUserMedia&&(void 0!==window.AudioContext||void 0!==window.webkitAudioContext);class f{setSpeechRecognition(e){let t=!!e&&(e===o||d());t&&(this.disableRecognition(),this.recognition=new e,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(t)}subscribe(e,t){this.subscribers[e]=t}unsubscribe(e){delete this.subscribers[e]}emitListeningChange(e){this.listening=e,Object.keys(this.subscribers).forEach(t=>{let{onListeningChange:i}=this.subscribers[t];i(e)})}emitMicrophoneAvailabilityChange(e){this.isMicrophoneAvailable=e,Object.keys(this.subscribers).forEach(t=>{let{onMicrophoneAvailabilityChange:i}=this.subscribers[t];i(e)})}emitTranscriptChange(e,t){Object.keys(this.subscribers).forEach(i=>{let{onTranscriptChange:n}=this.subscribers[i];n(e,t)})}emitClearTranscript(){Object.keys(this.subscribers).forEach(e=>{let{onClearTranscript:t}=this.subscribers[e];t()})}emitBrowserSupportsSpeechRecognitionChange(e){Object.keys(this.subscribers).forEach(t=>{let{onBrowserSupportsSpeechRecognitionChange:i,onBrowserSupportsContinuousListeningChange:n}=this.subscribers[t];i(e),n(e)})}disconnect(e){if(this.recognition&&this.listening)switch(e){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;default:this.pauseAfterDisconnect=!0,this.stop()}}disableRecognition(){this.recognition&&(this.recognition.onresult=()=>{},this.recognition.onend=()=>{},this.recognition.onerror=()=>{},this.listening&&this.stopListening())}onError(e){e&&e.error&&"not-allowed"===e.error&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}onRecognitionDisconnect(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}updateTranscript(e){let{results:t,resultIndex:i}=e,n=void 0===i?t.length-1:i;this.interimTranscript="",this.finalTranscript="";for(let e=n;e<t.length;++e)t[e].isFinal&&(!a()||t[e][0].confidence>0)?this.updateFinalTranscript(t[e][0].transcript):this.interimTranscript=c(this.interimTranscript,t[e][0].transcript);let s=!1;""===this.interimTranscript&&""!==this.finalTranscript?(this.previousResultWasFinalOnly&&(s=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,s||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}updateFinalTranscript(e){this.finalTranscript=c(this.finalTranscript,e)}resetTranscript(){this.disconnect("RESET")}startListening(){return n(function*(){let{continuous:e=!1,language:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.recognition)return;let i=e!==this.recognition.continuous,n=t&&t!==this.recognition.lang;if((i||n)&&(this.listening&&(yield this.stopListening()),this.recognition.continuous=i?e:this.recognition.continuous,this.recognition.lang=n?t:this.recognition.lang),!this.listening){this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript());try{yield this.start(),this.emitListeningChange(!0)}catch(e){e instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1)}}}).apply(this,arguments)}abortListening(){return n(function*(){this.disconnect("ABORT"),this.emitListeningChange(!1),yield new Promise(e=>{this.onStopListening=e})}).call(this)}stopListening(){return n(function*(){this.disconnect("STOP"),this.emitListeningChange(!1),yield new Promise(e=>{this.onStopListening=e})}).call(this)}getRecognition(){return this.recognition}start(){return n(function*(){this.recognition&&!this.listening&&(yield this.recognition.start(),this.listening=!0)}).call(this)}stop(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}abort(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}constructor(e){this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=()=>{},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(e),a()&&(this.updateFinalTranscript=(0,r.default)(this.updateFinalTranscript,250,{leading:!0}))}}let m="CLEAR_TRANSCRIPT",b="APPEND_TRANSCRIPT",y=(e,t)=>{switch(t.type){case m:return{interimTranscript:"",finalTranscript:""};case b:return{interimTranscript:t.payload.interimTranscript,finalTranscript:c(e.finalTranscript,t.payload.finalTranscript)};default:throw Error()}},x=!!o,v=x&&!a(),w=function(){let{transcribing:e=!0,clearTranscriptOnListen:t=!0,commands:i=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[n]=(0,s.useState)(T.getRecognitionManager()),[r,o]=(0,s.useState)(x),[a,d]=(0,s.useState)(v),[{interimTranscript:f,finalTranscript:w},R]=(0,s.useReducer)(y,{interimTranscript:n.interimTranscript,finalTranscript:""}),[S,j]=(0,s.useState)(n.listening),[C,L]=(0,s.useState)(n.isMicrophoneAvailable),M=(0,s.useRef)(i);M.current=i;let A=()=>{R({type:m})},E=(0,s.useCallback)(()=>{n.resetTranscript(),A()},[n]),k=(0,s.useCallback)((e,t)=>{M.current.forEach(i=>{let{command:n,callback:s,matchInterim:r=!1,isFuzzyMatch:o=!1,fuzzyMatchingThreshold:a=.8,bestMatchOnly:c=!1}=i,d=!t&&r?e.trim():t.trim(),f=(Array.isArray(n)?n:[n]).map(e=>{if(o){var t;let i=("object"==typeof e?e.toString():e).replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),n=((e,t)=>{if(e=e.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!e.length&&!t.length)return 1;if(!e.length||!t.length)return 0;if(e===t)return 1;if(1===e.length&&1===t.length||e.length<2||t.length<2)return 0;let i=new Map;for(let t=0;t<e.length-1;t++){let n=e.substring(t,t+2),s=i.has(n)?i.get(n)+1:1;i.set(n,s)}let n=0;for(let e=0;e<t.length-1;e++){let s=t.substring(e,e+2),r=i.has(s)?i.get(s):0;r>0&&(i.set(s,r-1),n++)}return 2*n/(e.length+t.length-2)})(i,d);return n>=a?{command:e,commandWithoutSpecials:i,howSimilar:n,isFuzzyMatch:!0}:null}let i=((t=e)instanceof RegExp?RegExp(t.source,"i"):RegExp("^"+(t=t.replace(p,"\\$&").replace(l,"(?:$1)?").replace(u,(e,t)=>t?e:"([^\\s]+)").replace(g,"(.*?)").replace(h,"\\s*$1?\\s*"))+"$","i")).exec(d);return i?{command:e,parameters:i.slice(1)}:null}).filter(e=>e);if(o&&c&&f.length>=2){f.sort((e,t)=>t.howSimilar-e.howSimilar);let{command:e,commandWithoutSpecials:t,howSimilar:i}=f[0];s(t,d,i,{command:e,resetTranscript:E})}else f.forEach(e=>{if(e.isFuzzyMatch){let{command:t,commandWithoutSpecials:i,howSimilar:n}=e;s(i,d,n,{command:t,resetTranscript:E})}else{let{command:t,parameters:i}=e;s(...i,{command:t,resetTranscript:E})}})})},[E]),O=(0,s.useCallback)((t,i)=>{e&&R({type:b,payload:{interimTranscript:t,finalTranscript:i}}),k(t,i)},[k,e]),N=(0,s.useCallback)(()=>{t&&A()},[t]);return(0,s.useEffect)(()=>{let e=T.counter;return T.counter+=1,n.subscribe(e,{onListeningChange:j,onMicrophoneAvailabilityChange:L,onTranscriptChange:O,onClearTranscript:N,onBrowserSupportsSpeechRecognitionChange:o,onBrowserSupportsContinuousListeningChange:d}),()=>{n.unsubscribe(e)}},[e,t,n,O,N]),{transcript:c(w,f),interimTranscript:f,finalTranscript:w,listening:S,isMicrophoneAvailable:C,resetTranscript:E,browserSupportsSpeechRecognition:r,browserSupportsContinuousListening:a}},T={counter:0,applyPolyfill:e=>{t?t.setSpeechRecognition(e):t=new f(e);let i=!!e&&d();x=i,v=i},removePolyfill:()=>{t?t.setSpeechRecognition(o):t=new f(o),v=(x=!!o)&&!a()},getRecognitionManager:()=>(t||(t=new f(o)),t),getRecognition:()=>T.getRecognitionManager().getRecognition(),startListening:function(){let{continuous:e,language:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n(function*(){let i=T.getRecognitionManager();yield i.startListening({continuous:e,language:t})})()},stopListening:()=>n(function*(){let e=T.getRecognitionManager();yield e.stopListening()})(),abortListening:()=>n(function*(){let e=T.getRecognitionManager();yield e.abortListening()})(),browserSupportsSpeechRecognition:()=>x,browserSupportsContinuousListening:()=>v};function R(e){return e.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\bredbox\b/g,"red box").split(/\s+/).filter(Boolean)}function S(e,t){if(e===t)return 0;if(!e.length)return t.length;if(!t.length)return e.length;let i=Array.from({length:e.length+1},()=>Array(t.length+1).fill(0));for(let t=0;t<=e.length;t+=1)i[t][0]=t;for(let e=0;e<=t.length;e+=1)i[0][e]=e;for(let n=1;n<=e.length;n+=1)for(let s=1;s<=t.length;s+=1){let r=+(e[n-1]!==t[s-1]);i[n][s]=Math.min(i[n-1][s]+1,i[n][s-1]+1,i[n-1][s-1]+r)}return i[e.length][t.length]}function j(e){return e.join(" ")}function C(e,t,i){let n=R(e);if(!n.length)return!1;let s=j(n),r=n.join("");return t.some(e=>{let t=R(e);if(!t.length)return!1;let o=j(t),a=t.join("");if(s.includes(o)||r.includes(a))return!0;if(n.length>=t.length){let e=n.slice(-t.length),s=j(e),r=e.join("");if(s.includes(o)||r.includes(a)||S(s,o)<=i||S(r,a)<=i)return!0}return!1})}e.s(["phrasesMatch",()=>C],61881)},18566,(e,t,i)=>{t.exports=e.r(76562)},52683,e=>{"use strict";e.s(["default",()=>p],52683);var t=e.i(43476),i=e.i(71645),n=e.i(48218),s=e.i(75254);let r=(0,s.default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),o=(0,s.default)("mic",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]]),a=(0,s.default)("mic-off",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]]);var c=e.i(18566),l=e.i(19455),h=e.i(99837),u=e.i(61881);let g=["open sesame","open seseme"];function p(){let e=(0,c.useRouter)(),{tolerance:s}=(0,h.useSpeechSettings)(),[p,d]=(0,i.useState)(null),[f,m]=(0,i.useState)(!1),b=(0,i.useRef)(null),[y,x]=(0,i.useState)(!1),{transcript:v,listening:w,browserSupportsSpeechRecognition:T,browserSupportsContinuousListening:R,isMicrophoneAvailable:S,resetTranscript:j}=(0,n.useSpeechRecognition)(),C=(0,i.useMemo)(()=>({language:"en-US",...R?{continuous:!0}:{}}),[R]);(0,i.useEffect)(()=>{x(!0)},[]),(0,i.useEffect)(()=>{b.current=new Audio("/audio/phrases/open-seseme.mp3");let e=b.current;if(!e)return;let t=()=>d(null);return e.addEventListener("ended",t),()=>{e.pause(),e.removeEventListener("ended",t)}},[]),(0,i.useEffect)(()=>{if(y&&T&&!f)return n.default.startListening(C).catch(()=>{}),()=>{n.default.stopListening().catch(()=>{})}},[T,f,y,C]),(0,i.useEffect)(()=>{v&&(0,u.phrasesMatch)(v,g,s)&&!f&&(m(!0),n.default.stopListening())},[f,s,v]),(0,i.useEffect)(()=>{if(!f)return;let t=setTimeout(()=>{e.push("/play")},600);return()=>clearTimeout(t)},[f,e]);let L=y&&T&&S,M=(0,i.useMemo)(()=>y?T?S?f?"Great job! Heading inside...":w?'Listening - say "Open Seseme"':"Tap the microphone to try again.":"We can't reach the microphone. Check your browser settings.":"Speech recognition is not supported in this browser.":"Getting the microphone ready...",[T,f,y,S,w]),A=async()=>{try{d(null);let e=b.current;if(!e)return;e.currentTime=0,await e.play()}catch(e){d("Could not play the prompt. Make sure audio is allowed.")}},E=async()=>{m(!1),j();try{await n.default.startListening(C)}catch(e){}};return(0,t.jsx)("main",{className:"relative flex min-h-screen flex-col items-center justify-center overflow-hidden bg-white px-4 py-12 text-slate-900",children:(0,t.jsxs)("div",{className:"relative z-10 flex max-w-2xl flex-col items-center gap-6 text-center",children:[(0,t.jsxs)("button",{type:"button",onClick:A,className:"group relative flex h-48 w-48 items-center justify-center rounded-full text-white","aria-label":"Play the Open Seseme prompt",children:[(0,t.jsx)("span",{className:"pointer-events-none absolute inset-0 rounded-full bg-[linear-gradient(135deg,_#5ee7df_0%,_#b490ca_100%)]"}),(0,t.jsx)("span",{className:"pointer-events-none absolute inset-0 rounded-full blur-3xl opacity-60",style:{background:"conic-gradient(from 180deg, rgba(94,231,223,0.35), rgba(180,144,202,0.35), rgba(255,182,193,0.25), rgba(94,231,223,0.35))"}}),(0,t.jsx)("span",{className:"relative z-10 text-4xl font-black drop-shadow-md",children:"Say & Play"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h1",{className:"text-3xl font-extrabold text-purple-900 md:text-4xl",children:"Open Seseme"}),(0,t.jsx)("p",{className:"text-base text-slate-800 md:text-lg",children:"Say the magic words to open the doors to adventure."}),p?(0,t.jsx)("p",{className:"text-sm text-rose-700",children:p}):null]}),(0,t.jsxs)("div",{className:"flex flex-col items-center gap-3 rounded-2xl bg-white p-6 text-slate-900 shadow-xl",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-base font-semibold text-slate-900",children:[L?w?(0,t.jsx)(r,{className:"h-5 w-5 animate-spin text-purple-700"}):(0,t.jsx)(o,{className:"h-5 w-5 text-purple-700"}):(0,t.jsx)(a,{className:"h-5 w-5 text-purple-700"}),(0,t.jsx)("span",{children:M})]}),v?(0,t.jsx)("p",{className:"rounded-xl bg-slate-100 px-4 py-2 text-sm text-slate-900 shadow-inner",children:v}):(0,t.jsx)("p",{className:"text-sm text-slate-700",children:"We will show what we hear right here."}),w||!L||f?null:(0,t.jsxs)(l.Button,{onClick:E,variant:"default",className:"gap-2 bg-purple-700 text-white hover:bg-purple-600",children:[(0,t.jsx)(o,{className:"h-4 w-4"}),"Try again"]}),y&&!T?(0,t.jsx)("p",{className:"text-sm text-rose-700",children:"Try using the latest version of Chrome, Edge, or Safari on desktop."}):null,y&&T&&!S?(0,t.jsx)("p",{className:"text-sm text-rose-700",children:"Allow microphone access so we can hear the magic words."}):null]})]})})}}]);